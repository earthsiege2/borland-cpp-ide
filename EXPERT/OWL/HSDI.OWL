##{hheader.snp}
##@OPT_APPL_TOOLBAR 2
#include <owl/controlb.h>
#include <owl/docking.h>
##@OPT_APPL_MAIL
#include <owl/mailer.h>
#include <owl/opensave.h>
##@OPT_APPL_PRINTING
#include <owl/printer.h>
##(@OPT_APPL_MRU) && (@QUERY_APPL_MODEL != VALUE_DIALOG)
#include <owl/rcntfile.h>

##@QUERY_APPL_OLE_AUTO
#include <ocf/automacr.h>
##@OPT_APPL_DRAGDROP 2
#include <classlib/bags.h>

##--BEGIN-- @OPT_APPL_PRINTING
#include "apxprint.h"
#include "apxprev.h"
##--END-- @OPT_APPL_PRINTING

##QUERY_FILENAME_CPP [[FileName]]
#include "[[FileName]].rh"            // Definition of all resources.


##@QUERY_APPL_COMMENT == VALUE_VERBOSE 3
//
// FrameWindow must be derived to override Paint for Preview and Print.
//
//{{TDecoratedFrame = TSDIDecFrame}}
class TSDIDecFrame : public TDecoratedFrame {
  public:
    TSDIDecFrame(TWindow* parent, const char far* title, TWindow* clientWnd, bool trackMenuSelection = false, TModule* module = 0);
    ~TSDIDecFrame();
##--BEGIN-- ((@QUERY_APPL_MODEL == VALUE_DIALOG) && (@OPT_APPL_TOOLBAR || @OPT_APPL_STATUSBAR))

//{{[[TApplication]]VIRTUAL_BEGIN}}
  public:
    virtual void SetupWindow();
##:DBVirtual("TSDIDecFrame", "SetupWindow")
//{{[[TApplication]]VIRTUAL_END}}
##--END-- ((@QUERY_APPL_MODEL == VALUE_DIALOG) && (@OPT_APPL_TOOLBAR || @OPT_APPL_STATUSBAR))
};    //{{TSDIDecFrame}}


//{{TApplication = [[TApplication]]}}
##(!@OPT_APPL_MRU) || (@QUERY_APPL_MODEL == VALUE_DIALOG)
class [[TApplication]] : public TApplication {
##(@OPT_APPL_MRU) && (@QUERY_APPL_MODEL != VALUE_DIALOG)
class [[TApplication]] : public TApplication, public TRecentFiles {
  private:
##--BEGIN-- @QUERY_APPL_MODEL != VALUE_DIALOG
##QUERY_WIND_CLIENT [[ClientClass]]
##<<*ClientClass QUERY_BASE_NAME [[BaseClient]]
##BaseClient == "TListBox" 2

    void LoadTextFile();                               // Read a file for ListBox client.
##--END-- @QUERY_APPL_MODEL != VALUE_DIALOG
##@OPT_APPL_HELP 3
    bool            HelpState;                          // Has the help engine been used.
    bool            ContextHelp;                        // SHIFT-F1 state(context sensitive HELP)
    TCursor*        HelpCursor;                         // Context sensitive help cursor.

## (((@QUERY_APPL_MODEL == VALUE_DIALOG) && @QUERY_APPL_DLGCLIENT_MENU) || (@QUERY_APPL_MODEL != VALUE_DIALOG))
##--BEGIN-- @OPT_APPL_TOOLBAR || @OPT_APPL_DRAGDROP
##@OPT_APPL_TOOLBAR
    void SetupSpeedBar(TDecoratedFrame* frame);
##@OPT_APPL_DRAGDROP
    void AddFile(const char* fileName);
##--END-- @OPT_APPL_TOOLBAR || @OPT_APPL_DRAGDROP
##--BEGIN-- @OPT_APPL_REGISTRY
    void ProcessCmdLine(char * CmdLine);
    void RegisterInfo();
    void UnRegisterInfo();
##--END-- @OPT_APPL_REGISTRY

  public:
    [[TApplication]]();
    virtual ~[[TApplication]]();

##@QUERY_APPL_MODEL != VALUE_DIALOG
    TOpenSaveDialog::TData FileData;                    // Data to control open/saveas standard dialog.
##@QUERY_APPL_OLE_AUTO 2
    TAppDescriptor*  Factory;                           // Automation descriptor.

##@QUERY_APPL_MODEL != VALUE_DIALOG 2
    void OpenFile(const char* fileName = 0);

##@OPT_APPL_TOOLBAR 2
    THarbor*        ApxHarbor;

##@OPT_APPL_PRINTING 5
    // Public data members used by the print menu commands and Paint routine in MDIChild.
    //
    TPrinter*       Printer;                            // Printer support.
    int             Printing;                           // Printing in progress.

//{{[[TApplication]]VIRTUAL_BEGIN}}
  public:
    virtual void InitMainWindow();
##:DBVirtual(\\"[[TApplication]]", "InitMainWindow")
##@OPT_APPL_REGISTRY
##:DBVirtual(\\"[[TApplication]]", "InitInstance")
    virtual void InitInstance();
##@OPT_APPL_HELP 2
##:DBVirtual(\\"[[TApplication]]", "CanClose")
    virtual bool CanClose();
##:DBVirtual(\\"[[TApplication]]", "ProcessAppMsg")
    virtual bool ProcessAppMsg(MSG& msg);
//{{[[TApplication]]VIRTUAL_END}}

//{{[[TApplication]]RSP_TBL_BEGIN}}
  protected:
##--BEGIN-- @QUERY_APPL_MODEL != VALUE_DIALOG
    void CmFileNew();
    void CmFileOpen();
##@OPT_APPL_PRINTING 4
    void CmFilePrint();
    void CmFilePrintSetup();
    void CmFilePrintPreview();
    void CmPrintEnable(TCommandEnabler& tce);
##--END-- @QUERY_APPL_MODEL != VALUE_DIALOG
##@OPT_APPL_HELP 2
    void CmHelpContents();
    void CmHelpUsing();
    void CmHelpAbout();
##@OPT_APPL_DRAGDROP
    void EvDropFiles(TDropInfo drop);
##@OPT_APPL_PRINTING
    void EvWinIniChange(char far* section);
##(@OPT_APPL_MRU) && (@QUERY_APPL_MODEL != VALUE_DIALOG)
    int32 CmFileSelected(uint wp, int32 lp);
//{{[[TApplication]]RSP_TBL_END}}
##--BEGIN-- @QUERY_APPL_OLE_AUTO

DECLARE_AUTOCLASS([[TApplication]])
AUTODETACH
//{{[[TApplication]]AUTO_TBL_BEGIN}}
//{{[[TApplication]]AUTO_TBL_END}}

##--END-- @QUERY_APPL_OLE_AUTO
DECLARE_RESPONSE_TABLE([[TApplication]]);
};    //{{[[TApplication]]}}
##{hfooter.snp}
